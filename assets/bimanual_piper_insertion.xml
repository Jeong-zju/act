<mujoco>
    <!-- <option timestep='0.001' iterations="50" tolerance="1e-10" solver="Newton" jacobian="dense" cone="elliptic"/> -->
    <!-- <option timestep="0.001" integrator="implicitfast"
        solver="Newton" iterations="80" tolerance="1e-10"
        cone="elliptic" impratio="10"
        noslip_iterations="2" noslip_tolerance="1e-8">
        <flag multiccd="enable"/>
    </option> -->
    <include file="scene_piper.xml"/>
    <include file="piper_dependencies.xml"/>

    <worldbody>
        <include file="piper_left.xml"/>
        <include file="piper_right.xml"/>

        <!-- <body name="peg" pos="0.2 0 0.05"> -->
        <body name="peg" pos="0.18 0 0.213">
            <joint name="red_peg_joint" type="free" frictionloss="0.01" />
            <inertial pos="0 0 0" mass="0.01" diaginertia="0.002 0.002 0.002" />
            <!-- <geom condim="4" solimp="2 1 0.01" solref="0.01 1" friction="1 0.005 0.0001" pos="0 0 0" size="0.06 0.01 0.01" type="box" name="red_peg" rgba="1 0 0 1" /> -->
            <geom condim="4" solimp="2 1 0.01" solref="0.01 1" friction="1 0.005 0.0001" pos="0 0 0" size="0.03 0.015 0.015" type="box" name="red_peg" rgba="1 0 0 1" />
        </body>

        <!-- <body name="socket" pos="0.2 -0.56376582 0.2" quat="0.707 0 0.707 0"> -->
        <body name="socket" pos="0.2 -0.1 0.1" quat="0.707 0 0.707 0">
            <joint name="blue_socket_joint" type="free" frictionloss="0.01" />
            <inertial pos="0 0 0" mass="0.01" diaginertia="0.002 0.002 0.002" />
           <!-- <geom condim="4" solimp="2 1 0.01" solref="0.01 1" friction="1 0.005 0.0001" pos="0 0 0" size="0.06 0.01 0.01" type="box" name="red_peg_ref" rgba="1 0 0 1" /> -->
            <geom condim="4" solimp="2 1 0.01" solref="0.01 1" friction="1 0.05 0.001" pos="0 0 -0.02" size="0.03 0.018 0.002" type="box" name="socket-1" rgba="0 0 1 1" />
            <geom condim="4" solimp="2 1 0.01" solref="0.01 1" friction="1 0.05 0.001" pos="0 0 0.02" size="0.03 0.018 0.002" type="box" name="socket-2" rgba="0 0 1 1" />
            <geom condim="4" solimp="2 1 0.01" solref="0.01 1" friction="1 0.05 0.001" pos="0 0.02 0" size="0.03 0.002 0.018" type="box" name="socket-3" rgba="0 0 1 1" />
            <geom condim="4" solimp="2 1 0.01" solref="0.01 1" friction="1 0.05 0.001" pos="0 -0.02 0" size="0.03 0.002 0.018" type="box" name="socket-4" rgba="0 0 1 1" />
            <geom condim="4" solimp="2 1 0.01" solref="0.01 1" friction="1 0.005 0.0001" pos="0.015 0 0" size="0.002 0.015 0.015" type="box" name="pin" rgba="1 0 0 1" />
        </body> 

    </worldbody>

    <equality>
        <!-- 将 peg 刚性焊到 piper_left/7_link7（注意：这里填的是“body 名称”，不是 geom 名称） -->
        <weld name="weld_peg_to_left_link6"
              body1="piper_left/link6"
              body2="peg"
              solref="0.001 1"
              solimp="0.95 0.99 0.001"/>
    </equality>

    <actuator>
        <position ctrllimited="true" ctrlrange="-2.618 2.618" joint="piper_left/joint1" kp="800" user="1" forcelimited="true" forcerange="-150 150"/>
        <position ctrllimited="true" ctrlrange="0 3.14" joint="piper_left/joint2" kp="1600" user="1" forcelimited="true" forcerange="-300 300"/>
        <position ctrllimited="true" ctrlrange="-2.967 0" joint="piper_left/joint3" kp="800" user="1" forcelimited="true" forcerange="-100 100"/>
        <position ctrllimited="true" ctrlrange="-1.745 1.745" joint="piper_left/joint4" kp="100" user="1" forcelimited="true" forcerange="-100 100"/>
        <position ctrllimited="true" ctrlrange="-1.22 1.22" joint="piper_left/joint5" kp="500" user="1"/>
        <position ctrllimited="true" ctrlrange="-2.0944 2.0944" joint="piper_left/joint6" kp="500" user="1"/>
        <position ctrllimited="true" ctrlrange="0 0.035" joint="piper_left/joint7" kp="1600" user="1" forcelimited="true" forcerange="-10000 10000"/>
        <position ctrllimited="true" ctrlrange="-0.035 0" joint="piper_left/joint8" kp="1600" user="1" forcelimited="true" forcerange="-10000 10000"/>

        <position ctrllimited="true" ctrlrange="-2.618 2.618" joint="piper_right/joint1" kp="800"  user="1" forcelimited="true" forcerange="-150 150"/>
        <position ctrllimited="true" ctrlrange="0 3.14" joint="piper_right/joint2" kp="1600"  user="1" forcelimited="true" forcerange="-300 300"/>
        <position ctrllimited="true" ctrlrange="-2.967 0" joint="piper_right/joint3" kp="800"  user="1" forcelimited="true" forcerange="-100 100"/>
        <position ctrllimited="true" ctrlrange="-1.745 1.745" joint="piper_right/joint4" kp="100"  user="1" forcelimited="true" forcerange="-100 100"/>
        <position ctrllimited="true" ctrlrange="-1.22 1.22" joint="piper_right/joint5" kp="500"  user="1"/>
        <position ctrllimited="true" ctrlrange="-2.0944 2.0944" joint="piper_right/joint6" kp="200"  user="1"/>
        <position ctrllimited="true" ctrlrange="0 0.035" joint="piper_right/joint7" kp="500" user="1"/>
        <position ctrllimited="true" ctrlrange="-0.035 0" joint="piper_right/joint8" kp="500" user="1"/>
    </actuator>

    <contact>
        <!-- <pair geom1="piper_left/7_link7" geom2="red_peg" condim="4" friction="1 1 0.02 0.0005 0.0005"/>
        <pair geom1="piper_left/8_link8" geom2="red_peg" condim="4" friction="1 1 0.02 0.0005 0.0005"/> -->
        <exclude body1="peg" body2="piper_left/link7"/>
        <exclude body1="peg" body2="piper_left/link8"/>
    </contact>

    <!-- <keyframe> -->
        <!-- <key qpos="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0  0.25 -0.28188 0.05 1 0 0 0"/> -->
        <!-- <key qpos="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0  0.2 0 0.05 1 0 0 0"/> -->
    <!-- </keyframe> -->

</mujoco>
